<!DOCTYPE HTML>
<html lang="ja"><head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="content-script-type" content="text/javascript" />
	<meta http-equiv="content-style-type" content="text/css" />
	<title>JSONP test</title>
</head><body>
<div id="wrapper">
<form method="GET">
<input type="text" name="foo" value="bar" />
<input type="submit" value="Start" />
</form>
<div id="contents"></div>
</div>
<script type="text/javascript">
var container = document.getElementById("contents");
function callback(elem) {
	container.innerHTML += elem.foo + "<br />";
}
document.forms[0].onsubmit = function() {
	var v = this.elements["foo"].value;
	setInterval(function() {
		var s = document.createElement("script");
		s.src = "http://localhost:8000/hoge.json?foo=" + v + "&callback=callback";
		s.onload = function() {
			document.body.removeChild(this);
		}
		document.body.appendChild(s);
	}, 3000);
	return false;
};
</script>
<!-- vim: set noet sw=2 ts=2 fileencoding=utf-8 : -->
</body></html>
